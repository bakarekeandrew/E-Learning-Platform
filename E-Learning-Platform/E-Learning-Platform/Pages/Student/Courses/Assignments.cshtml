@page "{courseId:int?}"
@model E_Learning_Platform.Pages.Student.Courses.AssignmentsModel
@{
    ViewData["Title"] = Model.CourseId.HasValue ? $"Assignments: {Model.CourseTitle}" : "My Assignments";
}

<div class="assignments-container">
    @if (!string.IsNullOrEmpty(Model.ErrorMessage))
    {
        <div class="alert alert-danger alert-dismissible fade show">
            @Model.ErrorMessage
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
    }

    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <nav aria-label="breadcrumb" class="mb-3">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a asp-page="/Student/Dashboard"><i class="bi bi-house-door"></i> Dashboard</a></li>
                    <li class="breadcrumb-item"><a asp-page="/Student/Courses"><i class="bi bi-book"></i> My Courses</a></li>
                    @if (Model.CourseId.HasValue)
                    {
                        <li class="breadcrumb-item"><a asp-page="/Student/Courses/View" asp-route-id="@Model.CourseId"><i class="bi bi-journal-text"></i> @Model.CourseTitle</a></li>
                        <li class="breadcrumb-item active" aria-current="page"><i class="bi bi-list-task"></i> Assignments</li>
                    }
                    else
                    {
                        <li class="breadcrumb-item active" aria-current="page"><i class="bi bi-list-task"></i> All Assignments</li>
                    }
                </ol>
            </nav>
            <h1 class="h2 mb-1 text-primary">
                @if (Model.CourseId.HasValue)
                {
                    <span>Assignments: @Model.CourseTitle</span>
                }
                else
                {
                    <span>My Assignments</span>
                }
                </h1>
            <p class="text-muted">
                <i class="bi bi-calendar-check"></i>
                @if (Model.HasPendingAssignments)
                {
                    <span>You have @Model.PendingAssignments assignments pending submission</span>
                }
                else
                {
                    <span>All assignments up to date</span>
                }
            </p>
        </div>

        <div class="dropdown">
            <button class="btn btn-outline-primary dropdown-toggle" type="button" id="assignmentFilterDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                <i class="bi bi-funnel"></i> Filter
            </button>
            <ul class="dropdown-menu" aria-labelledby="assignmentFilterDropdown">
                <li><a class="dropdown-item @(Model.Filter == "all" ? "active" : "")" href="?filter=all">All Assignments</a></li>
                <li><a class="dropdown-item @(Model.Filter == "pending" ? "active" : "")" href="?filter=pending">Pending</a></li>
                <li><a class="dropdown-item @(Model.Filter == "submitted" ? "active" : "")" href="?filter=submitted">Submitted</a></li>
                <li><a class="dropdown-item @(Model.Filter == "graded" ? "active" : "")" href="?filter=graded">Graded</a></li>
                <li><a class="dropdown-item @(Model.Filter == "upcoming" ? "active" : "")" href="?filter=upcoming">Due Soon</a></li>
                <li><a class="dropdown-item @(Model.Filter == "overdue" ? "active" : "")" href="?filter=overdue">Overdue</a></li>
            </ul>
        </div>
    </div>

    <!-- Assignments List -->
    <div class="row">
        @if (Model.Assignments != null && Model.Assignments.Any())
        {
            foreach (var assignment in Model.Assignments)
            {
                <div class="col-12 mb-4">
                    <div class="card assignment-card shadow @GetCardClass(assignment)">
                        <div class="card-body">
                            <div class="d-flex justify-content-between align-items-start mb-3">
                                <div>
                                    <h5 class="card-title text-primary mb-1">@assignment.Title</h5>
                                    @if (!Model.CourseId.HasValue)
                                    {
                                        <p class="text-muted small mb-2">
                                            <i class="bi bi-book"></i> @assignment.CourseTitle
                                        </p>
                                    }
