-- Create CERTIFICATES table
CREATE TABLE CERTIFICATES (
    CERTIFICATE_ID INT IDENTITY(1,1) PRIMARY KEY,
    USER_ID INT NOT NULL,
    COURSE_ID INT NOT NULL,
    ISSUE_DATE DATETIME NOT NULL,
    CERTIFICATE_NUMBER NVARCHAR(50) NOT NULL,
    VERIFICATION_CODE NVARCHAR(50) NOT NULL,
    CERTIFICATE_URL NVARCHAR(255),
    CONSTRAINT FK_CERTIFICATES_USERS FOREIGN KEY (USER_ID) REFERENCES USERS(USER_ID),
    CONSTRAINT FK_CERTIFICATES_COURSES FOREIGN KEY (COURSE_ID) REFERENCES COURSES(COURSE_ID),
    CONSTRAINT UQ_CERTIFICATE_NUMBER UNIQUE (CERTIFICATE_NUMBER),
    CONSTRAINT UQ_VERIFICATION_CODE UNIQUE (VERIFICATION_CODE)
);

-- Add index for faster lookups
CREATE INDEX IX_CERTIFICATES_USER_COURSE ON CERTIFICATES(USER_ID, COURSE_ID);
CREATE INDEX IX_CERTIFICATES_VERIFICATION ON CERTIFICATES(VERIFICATION_CODE); 